---
- name: Systemd service for dockge should exist
  ansible.builtin.copy:
    dest: /etc/systemd/system/dockge.service
    mode: '0644'
    content: |
      [Unit]
      Description=Dockge
      After=network.target
      Requires=network.target
      [Service]
      Type=simple
      WorkingDirectory=/opt/dockge
      ExecStart=/bin/podman-compose up
      ExecStop=/bin/podman-compose down
      Restart=always
      RestartSec=10
      [Install]
      WantedBy=multi-user.target

- name: Systemd service dockge should be enabled and started
  ansible.builtin.systemd:
    name: dockge
    enabled: true
    state: started
    daemon_reload: true
